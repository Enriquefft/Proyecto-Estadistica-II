```{r}
library(randtests)
```


time: Time spent since 6:00am to get the first ride of the day.
count: Nuber of passengers in the first ride of the day.


```{r}
time_street <- c(3, 5, 8, 4, 6, 9, 11, 3)  
count_street <- c(2, 3, 1, 4, 3, 4, 4, 1) 

time_app <- c(3, 5, 9, 1, 2, 7, 4, 8)  
count_app <- c(2, 1, 1, 3, 2, 1, 2, 1) 

time_phone <- c(1, 3, 4, 0, 2, 3, 3, 1 ) 
count_phone <- c(2, 3, 1, 4, 0, 4, 0, 2) 

significance = 0.05
```


## P1



Sea X la muestra total formada por todos los tiempos dados en X1, X2, X3 (en ese orden).
¿Puede afirmarse que esta muestra es aleatoria con una mediana poblacional superior a 5 minutos?

```{r}
muestra <- c(time_street, time_app, time_phone)
tamano_muestra <- length(muestra)
```

H0: la muestra es aleatoria
Ha: la muestra no es aleatoria

```{r}
summary(muestra)
runs.test(muestra)
```





## P2



Sea Y la muestra total formada por  Y1, Y2, Y3 (en ese orden).

¿Puede afirmarse que el número de pasajeros por cada servicio de taxi , sigue una distribución binomial?


```{r}
muestra <- c(count_street, count_app, count_phone)
muestra

k = 5
gl <- k-1



```

table de frecuencias
```{r}
X<-c(0,1,2,3)

O<-c(300,150,100,50)
n <- 600
Ex <- sum(X * O) / 600
p0 <- Ex / 3
p <- dbinom(0:3, 3, p0)
p
E <- n * p
E
CHI <- (O-E)*(O-E) / E

```

```{r}

n <- sum(frecuencias$Freq)

xi <- c(0, 1, 2, 3, 4)
oi <- frecuencias$Freq

Ex <- sum(xi * oi) / n
p0 <- Ex / 4

p <- dbinom(0:4, 4, p0)

E <- n * p


CHI <- (oi-E)*(oi-E) / E
(CHI)
sum(CHI)

crit <- qchisq(1-significance, gl)
crit


```

## P3

Con un anterior aplicativo, el tiempo para conseguir un primer servicio, con los mismos taxis del aplicativo actual, estuvo dado por:

AntApp<-c(4, 6, 3, 6, 8, 10, 2, 6)    # en minutos

¿puede afirmarse que con el nuevo aplicativo se ha mejorado?


```{r}
old_time_app<-c(4, 6, 3, 6, 8, 10, 2, 6)
diff <- old_time_app - time_app
summary(diff)

wilcox.test(diff, alternative = "greater")



```



## P4

1) Haga un estudio completo acerca de los tiempos para conseguir un primer servicio. (Hipótesis, Estadístico de prueba, Región crítica, Valor crítico, Decisión y conclusión).

sea $\mu_i$ el tiempo promedio para conseguir un primer servicio con el i-ésimo modo de adquisición.
H0 : $\mu_1 = \mu_2 = \mu_3$
Ha: $\exists i \neq j$ tal que $\mu_i \neq \mu_j$


```{r}
df <- data.frame(
  street = time_street,
  app = time_app,
  phone = time_phone
)
j <- 8
k <- 3
y1 <- sum(df$street)
y1_mean <- y1 / length(df$street)
y2 <- sum(df$app)
y2_mean <- y2 / length(df$app)
y3 <- sum(df$phone)
y3_mean <- y3 / length(df$phone)

n <- length(df$street)+ length(df$app)+ length(df$phone)

y <- y1 + y2 + y3
y_mean <- y / n



SCT <- sum((df$street - y_mean)^2) + sum((df$app - y_mean)^2) + sum((df$phone - y_mean)^2)

SCE <- sum((df$street - y1_mean)^2) + sum((df$app - y2_mean)^2) + sum((df$phone - y3_mean)^2)

SCTr <- j*((y1_mean - y_mean)^2) + j*((y2_mean - y_mean)^2) + j*((y3_mean - y_mean)^2)

SCT
SCE
SCTr

```






## P5

Se va a comparar el pago promedio por los clientes,  para cada tipo de servicio,  con los mismos taxis de la data inicial.

Ya se sabe que $\overline{Y_1} = 18$
soles.  Obtener el Intervalo de confianza para $\mu_1$

Los datos muestrales de los pagos se han extraviado, pero se ha logrado rescatar  algunos datos para que pueda llenar la tabla de ANOVA respectiva:

```{r}
ANOVA_table <- data.frame(FUENTE = c("Tratamientos", "Error", "Total"), GL = c(NA, NA, NA), SC = c(NA, NA, 520), CM = c(NA, NA, NA), Fo = c(NA, NA, NA), P_VALOR = c(0.1061897, NA, NA))
ANOVA_table
```

```{r}
# Datos iniciales
Pano <- 0.1061897
SCT = 520
y_mean <- 18
j <- 8
k <- 3
n <- 24



#520 <- sum((df$street - 18)^2) + sum((df$app - 18)^2) + sum((df$phone - 18)^2)


f0 <- qf(Pano, k, n-k-1)
f0
#scr / sce  = f0 * k / (n-k-1)
scr_sce <- f0 * k / (n-k-1) # scr / sce
# SCR + SCE = SCT
scr <- SCT * scr_sce / (1 + scr_sce)
sce <- SCT - scr


ANOVA_table <- data.frame(FUENTE = c("Tratamientos", "Error", "Total"), GL = c(k-1, n-k, n-1), SC = c(scr, sce, SCT), CM = c(scr/k, sce/n-k-1, NA), Fo = c(f0, NA, NA), P_VALOR = c(0.1061897, NA, NA))
ANOVA_table

```

