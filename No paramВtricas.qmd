---
title: "No paramétrica"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

\###################################################################

```{r}
pbinom(6,20, 0.5)
```

\###################################################################

```{r}
library(readr)
library(plyr)
library(dplyr)

```

**PRUEBAS NO PARAMÉTRICAS**

1\) PRUEBA DE SIGNOS:

Es para realizar pruebas de hipótesis sobre la mediana.

Problema 1:

Debido al uso frecuente de la laptop, la empresa SOLUCIONES TECNOLÓGICAS recibe muchos pedidos de baterías, los cuales los trae de Estados Unidos y los precios son muy variados. La empresa sospecha que el precio mediano que el cliente debe pagar es S/ 2000 . Use 5% de significación y compruebe si es cierto o no lo que sospechan.

Datos:

Cbat: costo de baterías.

```{r}
Cbat<- c(2158.7, 1678.15, 2316, 2061.3, 2207.5, 1708.3, 1784.7, 2575.1, 2357.9, 2256.7, 2165.2, 2399.55, 1779.8, 2336.75, 1765.3, 2053.5, 2414.4, 2200.5, 2654.2, 1753.7  )
Cbat    # costo de baterías
```

SOLUCIÓN:

HIPÓTESIS:

$$
\begin{align*}
& Ho: Me=2000\\
& Ha: Me \neq 2000
\end{align*}
$$

Cálculo del p-valor cuando Ha: DIFERENTE

```{r}
pvalor<- 2*pbinom(6,20,0.5)
pvalor
```

Como este pvalor es \> que alfa ==\> Acepto Ho==\> Con 5% de significación puede considerarse que la mediana es 2000.

Perooooo, con R studio:

\*\*Para realizar la PRUEBA DE SIGNOS con R:\*\*

```{r}
install.packages("BSDA")
```

cargar libreria

```{r}
library("BSDA")
```

Se usa SIGN.test

```{r}
SIGN.test(Cbat, md=2000, alternative = "two.sided", conf.level = 0.95)
```

s=14 ( hay 14 positivos)

pvalor= 0.1153.

Por ser mayor que alfa se debe aceptar Ho.

Además, solo cuando la Alternativa sea "diferente", se obtendrá el intervalo de confianza de la mediana.

**Prob 2:**

*Se presentan las notas del último examen parcial del curso de Estadística General de una muestra de 10 estudiantes que fueron elegidos al azar . Se afirma que la mediana poblacional de las notas es mayor a 13. Probar si dicha afirmación es cierta al nivel de significación del 5%.*

**Datos:**

```{r}
notas<-c(9, 12, 8, 8, 15, 11,8,11,13,15)
```

SOLUCIÓN:

Hipótesis:

$$
Ho: Me \le 13
$$

$$
Ha: Me> 13
$$

```{r}
pbinom(1, 9, 0.5, lower.tail=FALSE)
```

Como este pvalor=0.9804 es mayor que alfa ==\> Acepto Ho: la mediana es a lo mas 13. No es mayor que 13, con 5% de signicación.

***Con R studio, todo:***

```{r}
SIGN.test(notas,md=13, alternative = "greater", conf.level = 0.95)
```

como pvalor= 0.9805 \> alfa ==\> acepto Ho.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

**PRUEBA DE RACHAS:**

Es para determinar si la muestra es aleatoria o no.

```{r}
install.packages("randtests")
```

Y además

```{r}
library("randtests")
```

**Ejemplo 3:**

De una sección de inglés se acaba de tomar su examen final. A solicitud del director, se ha seleccionado un grupo de alumnos de los 50 que rindieron el final. ¿Será este conjunto una muestra aleatoria de las notas? Use 95%

Datos: Notas de inglés

```{r}
NOTAS<- c(93,82,96,98,92,96,85,94,95,95,76,71,74)
```

Solución:

$$
Ho: \text{la muestra es aleatoria}
$$

$$
Ha: \text{la muestra no es aleatoria}
$$

Hallamos la mediana

```{r}
summary(NOTAS)
```

Mediana= 93.

```{r}
runs.test(NOTAS)
```

runs=7 (# de rachas)

n1=6(+)

n2=6(-)

**pvalor=1 \> alfa** ==\> Acepto Ho ==\> con 5% de significación, se tiene que los datos si son aleatorios.

**Ejemplo 4:**

*Para realizar un proyecto del curso de Estadística 2, un grupo de alumnos, presenta una lista de datos que representan a sus edades. El profesor sospecha que las edades presentadas no corresponden a una muestra aleatoria. Por ello decide realizar una prueba de rachas, con 5% de significación. ¿A qué conclusión se llegará?*

*DATOs: 15, 22, 18, 21, 20, 18, 17, 19, 21, 22, 18, 22, 18, 17, 16, 15, 14, 16, 18, 20,*

*15, 20, 18, 15,16*

**SOLUCIÓN:**

Solución:

$$ Ho: \text{la muestra es aleatoria} $$

$$ Ha: \text{la muestra no es aleatoria} $$

Hallamos la mediana

```{r}
EDAD<-c(15, 22, 18, 21, 20, 18, 17, 19, 21, 22, 18, 22, 18, 17, 16, 15, 14, 16, 18, 20, 15, 20, 18, 15, 16)
```

mediana:

```{r}
summary(EDAD)
```

mediana = 18 etc.

con R studio:

runs.test

```{r}
runs.test(EDAD)
```

pvalor= 0.4853 \> alfa ==\> no rechazo Ho : los datos son aleatorios.

\####################################################################################

Hasta aqui martes 13.

**PROBLEMA 5:**

Para comprobar si el juego de LA TINKA es aleatorio, se ha seleccionado 10 bolillas:

12, 16, 15, 40, 26, 17, 22, 26, 12, 34

Usando 5% de significación, determine si se trata de un juego correcto.

**SOLUCIÓN:**

La tinka

```{r}
tinka<- c(12,16,15,40,26,17,22,26,12,34)
```

```{r}
summary(tinka)
```

con R: runs.tests

```{r}
runs.test(tinka)
```

n1=5 (+)

n2=5 (-)

Como P valor \> alfa ==\> Acepto Ho: la muestra si es aleatoria.

**Prueba de normalidad de KS (Kolmogorov- Smirnov)**

**ejemplo 1**

Se está evaluando las medidas de glucosa de algunos pacientes. Para realizar una prueba de hipótesis para la cantidad promedio de glucosa es necesario saber si estos datos provienen de una distribución normal. Con 5% ¿puede afirmarse que los datos provienen de una normal con media 80 y desviación 6 en glucosa?

```{r}
glucosa<-c(80,80,77,72,81,76,78,81,86,80,77,77,92,68,87,84,75,78,86,78,76,80,81,72,77,92,80,75,84,80,77,68,87,92,77,92)
glucosa
```

SOLUCION:

Hipótesis:

$$
Ho: \text{Los datos siguen una Normal con media 80 y desviación 6}
$$

$$
Ha: \text{Los datos no siguen una normal con media 80 y desviación 6}
$$

table

```{r}
table(glucosa)
```

Se acaba de hallar los valores de la columna X y sus respectivas fi (frecuencias)

Ahora generamos la tabla de Kolmogorov.

```{r}

```

```{r}
N<- 36  # número de datos o tamaño de muestra

mu<-80  # la media de la normal

sigma<-6  # la desviación de la normal

xi<-c(68, 72, 75, 76, 77, 78, 80, 81, 84, 86, 87, 92 ) # copiando los datos

fi<-c(2,  2 , 2 , 2 , 6,  3 , 6 , 3 , 2 , 2 , 2,  4 ) # copiando los datos

Fi<-c(2,4,6,8,14,17,23,26,28,30,32,36) # calculando manualmente cada uno.

FS<-Fi/N  # frecuencia relativa

zi<-(xi-mu)/sigma

FT<-pnorm(zi,0,1)  # con media 0 y desviación 1. ==> Probabilidades.

#dif1<-abs(FT-FS)

FS_1<-c(0,FS)  # Frecuencias relativas con valor  anterior

#dif2<-abs(FT-FS_1)

print(paste("valores de xi"))

xi

print(paste("valores de fi"))

fi

print(paste("Valores de Fi"))

Fi

print(paste("valores de FS"))

FS

print(paste("valores de zi"))

zi

print(paste("valores de FT"))

FT

print(paste("valores de FS_ant"))

FS_ant<-FS_1[-c(13)]

FS_ant

dif1<-abs(FT-FS)

print(paste("valores de dif1"))

dif1

D1<- max(dif1)
print(paste("el máximo D1 es",D1 ))


dif2<-abs(FT-FS_ant)

print(paste("valores de dif2"))

dif2
D2<-max(dif2)
print(paste("el máximo D2 es", D2))
```

Ahora se escoge

**D1= 0.156038390**

**D2= 0.09121727**

y se escoge el mayor :

**D= 0.156038390 (estadistico de prueba).**

Calculo de D_alfa:

```{r}
nf<- 12 # numero de filas
D_alfa<- 0.895/(sqrt(nf)-0.01+ 0.85/sqrt(nf))
D_alfa
```

como D= 0.1569 \< D_alfa ==\> Acepto Ho : El nivel de glucosa si corresponde a una Normal con media 80 y desviación 6.

**OTRA FORMA:**

-   prueba de \*\*ks.test\*\* conociendo media y desviación

\`\`\`{r}

ks.test(glucosa,pnorm,mean=80,sd=6)

\`\`\`

```{r}
ks.test(glucosa,pnorm,mean=80,sd=6)
```

Como p-valor = 0.3447 \> Alfa= 0.05 ==\> No rechazo Ho: Acepto Ho ==\> Los datos corresponden a una distribución normal.

\#############################

-   prueba de \*\*ks.test\*\* sin conocer media y desviación

Resolviendo el problema anterior de Glucosa, pero sin conocer mu y sigma:

**ks.test:**

```{r}
ks.test(glucosa,pnorm,mean(glucosa),sd(glucosa))
```

Ahora se obtiene p-valor =0.2914 \> alfa ==\> no rechazo Ho: acepto Ho ==\> la muestra de Glucosa si es normal.

**Ejemplo 2:**

Las 12 notas siguientes fueron enviadas al director de carrera, en un curso de Programación. Con 5% de significación ¿Se puede afirmar que provienen de una distribución normal?

```{r}
nfinal<-c(13.38,12.69,13.66,16.46,15.14,17.21,14.15,16.06,14.52,11.92,12.13,14.56)
```

**SOLUCIÖN:**

Hipótesis:

$$ Ho: \text{Los datos siguen una Normal con media 80 y desviación 6} $$

$$ Ha: \text{Los datos no siguen una normal con media 80 y desviación 6} $$

prueba de ks.test

```{r}
ks.test(nfinal,pnorm,mean(nfinal),sd(nfinal))
```

Estadistico de prueba= D= 0.11087

P-valor= 0.9946 \> alfa = 0.05 ==\> No rechazo Ho = Acepto Ho ==\> Los datos si siguen una distribución normal.

**PRUEBA DE INDEPENDENCIA**

**Ejemplo:**

Utilizando la base de datos del parcial "DatosBuses.csv" y con 5% de significación, compruebe si las variables Destino y Servicio son o no, independientes.

```{r}
DB<-read_csv("DatosBuses.csv")

DB
```

Hipótesis:

$$
Ho: \text{Las variables son independientes}
$$

$$
Ha: \text{Las variables si son dependientes}
$$

1\) Tabla de Destino y Servicio

```{r}
tab<- table(DB$Destino, DB$Servicio)

tab
```

aqui se tiene:

m=4 filas y n= 3 columnas.

Grados de libertad: =(4-1)x(3-1)=6

Además:

Total de filas:

7

53

82

58

Total de columnas: 53, 69, 78 ==\> 200

**2) Cálculo de los valores esperados:**

```{r}
chisq.test(tab)$expected # Ver valores esperados en la tabla cruzada
```

Obteniendo el estadístico de prueba:

```{r}
chisq.test(tab) # estadístico y p-valor
```

Como P-valor = 0.4101 \> alfa ==\>No rechazo Ho = Acepto Ho ==\> Destino y Servicio son independientes.

Además:

**X-squared = 6.1176**\*\* es el estadístico de prueba.

Para hallar el valor crítico, notar que siempre la región sombreada es por la derecha (cola derecha).

valor critico:

```{r}
qchisq(0.95,6)
```

\###########################################

\###########################################

Como **X-squared = 6.1176** no cae en la región sombreada, entonces no rechazo Ho ==\> Los datos son independientes.

```{r}
qchisq(0.95,2)
```

\`\`\`{r}

qchisq(0.9,2)

```         
```

\*PRUEBA DE BONDAD DE AJUSTE\*

Probando binomial:

\`\`\`{r}

X\<-c(0,1,2,3)

O\<-c(300,150,100,50)

\`\`\`

Binomial necesita n y po

Según el texto n=3 y po no se conoce.

Pero se sabe que en binomial E(X)=n.po

Ademas para toda variable discreta: \$E(X)=\\frac{\\sum\_{i=1}\^{k} X\_{i}\*f\_{i}}{N}\$

\`\`\`{r}

EX\<- (X%\*%O)/600

EX

\`\`\`

Cálculo de p: (EX=np ==\> p=EX/n)

\`\`\`{r}

po\<- EX/3

po

\`\`\`

Ahora hallamos las probabilidades con binomial:

\`\`\`{r}

P\<- dbinom(0:3,3,po)

P

sum(P)

\`\`\`

Cálculo de frecuencias esperadas:

\`\`\`{r}

E\<- 600\*P

E

sum(E)

\`\`\`

contribución a chi:

\`\`\`{r}

Chi\<- (O-E)\*(O-E)/E

Chi

\`\`\`

Estadistico:

\`\`\`{r}

CHIo\<- sum(Chi)

CHIo

\`\`\`

\`\`\`{r}

qchisq(0.95,2)

\`\`\`

PRUEBA DE SIGNOS QFive

\`\`\`{r}

Datos\<-c(21, 30, 25, 20, 24, 19, 21, 24, 22, 26, 28, 18, 20, 24)

SIGN.test(Datos, md=25, alternative = "less", conf.level = 0.95)

\`\`\`
